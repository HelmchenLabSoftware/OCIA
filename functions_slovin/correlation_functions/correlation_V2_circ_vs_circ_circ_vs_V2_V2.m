%
cc_circ_V2_1111c14_cont=mean(a(roi_contour2,:,:),3);
cc_circ_V2_1111c14_non=mean(b(roi_contour2,:,:),3);

cc_V2_V2_1111c14_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1111c14_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1111c14_cont=mean(c(roi_contour2,:,:),3);
cc_circ_circ_1111c14_non=mean(d(roi_contour2,:,:),3);

cc_circ_V22_1111c14_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1111c14_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1111c25_cont=mean(a(roi_contour2,:,:),3);
cc_circ_V2_1111c25_non=mean(b(roi_contour2,:,:),3);

cc_V2_V2_1111c25_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1111c25_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1111c25_cont=mean(c(roi_contour2,:,:),3);
cc_circ_circ_1111c25_non=mean(d(roi_contour2,:,:),3);

cc_circ_V22_1111c25_cont=mean(c(roi_V2,:,:),3);
cc_circ_V22_1111c25_non=mean(d(roi_V2,:,:),3);

%
cc_circ_V2_1111d14_cont=mean(a(roi_contour2,:,:),3);
cc_circ_V2_1111d14_non=mean(b(roi_contour2,:,:),3);

cc_V2_V2_1111d14_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1111d14_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1111d14_cont=mean(c(roi_contour2,:,:),3);
cc_circ_circ_1111d14_non=mean(d(roi_contour2,:,:),3);

cc_circ_V22_1111d14_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1111d14_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1111d25_cont=mean(a(roi_contour2,:,:),3);
cc_circ_V2_1111d25_non=mean(b(roi_contour2,:,:),3);

cc_V2_V2_1111d25_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1111d25_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1111d25_cont=mean(c(roi_contour2,:,:),3);
cc_circ_circ_1111d25_non=mean(d(roi_contour2,:,:),3);

cc_circ_V22_1111d25_cont=mean(c(roi_V2,:,:),3);
cc_circ_V22_1111d25_non=mean(d(roi_V2,:,:),3);

%
cc_circ_V2_1811c_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1811c_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1811c_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1811c_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1811c_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1811c_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1811c_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1811c_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1811d_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1811d_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1811d_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1811d_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1811d_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1811d_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1811d_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1811d_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1811e_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1811e_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1811e_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1811e_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1811e_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1811e_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1811e_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1811e_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_2511d_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_2511d_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_2511d_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_2511d_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_2511d_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_2511d_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_2511d_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_2511d_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_2511e_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_2511e_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_2511e_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_2511e_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_2511e_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_2511e_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_2511e_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_2511e_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_2511f_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_2511f_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_2511f_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_2511f_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_2511f_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_2511f_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_2511f_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_2511f_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1203d_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1203d_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1203d_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1203d_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1203d_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1203d_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1203d_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1203d_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1203e_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1203e_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1203e_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1203e_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1203e_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1203e_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1203e_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1203e_non=mean(b(roi_V2,:,:),3);

%
cc_circ_V2_1203f_cont=mean(a(roi_contour,:,:),3);
cc_circ_V2_1203f_non=mean(b(roi_contour,:,:),3);

cc_V2_V2_1203f_cont=mean(a(roi_V2,:,:),3);
cc_V2_V2_1203f_non=mean(b(roi_V2,:,:),3);

cc_circ_circ_1203f_cont=mean(c(roi_contour,:,:),3);
cc_circ_circ_1203f_non=mean(d(roi_contour,:,:),3);

cc_circ_V22_1203f_cont=mean(a(roi_V2,:,:),3);
cc_circ_V22_1203f_non=mean(b(roi_V2,:,:),3);





%%

cc_circ_V2_cont(:,1)=mean(cc_circ_V2_1111c14_cont,1);
cc_circ_V2_cont(:,2)=mean(cc_circ_V2_1111c25_cont,1);
cc_circ_V2_cont(:,3)=mean(cc_circ_V2_1111d14_cont,1);
cc_circ_V2_cont(:,4)=mean(cc_circ_V2_1111d25_cont,1);
cc_circ_V2_cont(:,5)=mean(cc_circ_V2_1811c_cont,1);
cc_circ_V2_cont(:,6)=mean(cc_circ_V2_1811d_cont,1);
cc_circ_V2_cont(:,7)=mean(cc_circ_V2_1811e_cont,1);
cc_circ_V2_cont(:,8)=mean(cc_circ_V2_2511d_cont,1);
cc_circ_V2_cont(:,9)=mean(cc_circ_V2_2511e_cont,1);
cc_circ_V2_cont(:,10)=mean(cc_circ_V2_2511f_cont,1);
cc_circ_V2_cont(:,11)=mean(cc_circ_V2_1203d_cont,1);
cc_circ_V2_cont(:,12)=mean(cc_circ_V2_1203e_cont,1);
cc_circ_V2_cont(:,13)=mean(cc_circ_V2_1203f_cont,1);


cc_circ_V2_non(:,1)=mean(cc_circ_V2_1111c14_non,1);
cc_circ_V2_non(:,2)=mean(cc_circ_V2_1111c25_non,1);
cc_circ_V2_non(:,3)=mean(cc_circ_V2_1111d14_non,1);
cc_circ_V2_non(:,4)=mean(cc_circ_V2_1111d25_non,1);
cc_circ_V2_non(:,5)=mean(cc_circ_V2_1811c_non,1);
cc_circ_V2_non(:,6)=mean(cc_circ_V2_1811d_non,1);
cc_circ_V2_non(:,7)=mean(cc_circ_V2_1811e_non,1);
cc_circ_V2_non(:,8)=mean(cc_circ_V2_2511d_non,1);
cc_circ_V2_non(:,9)=mean(cc_circ_V2_2511e_non,1);
cc_circ_V2_non(:,10)=mean(cc_circ_V2_2511f_non,1);
cc_circ_V2_non(:,11)=mean(cc_circ_V2_1203d_non,1);
cc_circ_V2_non(:,12)=mean(cc_circ_V2_1203e_non,1);
cc_circ_V2_non(:,13)=mean(cc_circ_V2_1203f_non,1);




cc_circ_circ_cont(:,1)=mean(cc_circ_circ_1111c14_cont,1);
cc_circ_circ_cont(:,2)=mean(cc_circ_circ_1111c25_cont,1);
cc_circ_circ_cont(:,3)=mean(cc_circ_circ_1111d14_cont,1);
cc_circ_circ_cont(:,4)=mean(cc_circ_circ_1111d25_cont,1);
cc_circ_circ_cont(:,5)=mean(cc_circ_circ_1811c_cont,1);
cc_circ_circ_cont(:,6)=mean(cc_circ_circ_1811d_cont,1);
cc_circ_circ_cont(:,7)=mean(cc_circ_circ_1811e_cont,1);
cc_circ_circ_cont(:,8)=mean(cc_circ_circ_2511d_cont,1);
cc_circ_circ_cont(:,9)=mean(cc_circ_circ_2511e_cont,1);
cc_circ_circ_cont(:,10)=mean(cc_circ_circ_2511f_cont,1);
cc_circ_circ_cont(:,11)=mean(cc_circ_circ_1203d_cont,1);
cc_circ_circ_cont(:,12)=mean(cc_circ_circ_1203e_cont,1);
cc_circ_circ_cont(:,13)=mean(cc_circ_circ_1203f_cont,1);


cc_circ_circ_non(:,1)=mean(cc_circ_circ_1111c14_non,1);
cc_circ_circ_non(:,2)=mean(cc_circ_circ_1111c25_non,1);
cc_circ_circ_non(:,3)=mean(cc_circ_circ_1111d14_non,1);
cc_circ_circ_non(:,4)=mean(cc_circ_circ_1111d25_non,1);
cc_circ_circ_non(:,5)=mean(cc_circ_circ_1811c_non,1);
cc_circ_circ_non(:,6)=mean(cc_circ_circ_1811d_non,1);
cc_circ_circ_non(:,7)=mean(cc_circ_circ_1811e_non,1);
cc_circ_circ_non(:,8)=mean(cc_circ_circ_2511d_non,1);
cc_circ_circ_non(:,9)=mean(cc_circ_circ_2511e_non,1);
cc_circ_circ_non(:,10)=mean(cc_circ_circ_2511f_non,1);
cc_circ_circ_non(:,11)=mean(cc_circ_circ_1203d_non,1);
cc_circ_circ_non(:,12)=mean(cc_circ_circ_1203e_non,1);
cc_circ_circ_non(:,13)=mean(cc_circ_circ_1203f_non,1);





cc_V2_V2_cont(:,1)=mean(cc_V2_V2_1111c14_cont,1);
cc_V2_V2_cont(:,2)=mean(cc_V2_V2_1111c25_cont,1);
cc_V2_V2_cont(:,3)=mean(cc_V2_V2_1111d14_cont,1);
cc_V2_V2_cont(:,4)=mean(cc_V2_V2_1111d25_cont,1);
cc_V2_V2_cont(:,5)=mean(cc_V2_V2_1811c_cont,1);
cc_V2_V2_cont(:,6)=mean(cc_V2_V2_1811d_cont,1);
cc_V2_V2_cont(:,7)=mean(cc_V2_V2_1811e_cont,1);
cc_V2_V2_cont(:,8)=mean(cc_V2_V2_2511d_cont,1);
cc_V2_V2_cont(:,9)=mean(cc_V2_V2_2511e_cont,1);
cc_V2_V2_cont(:,10)=mean(cc_V2_V2_2511f_cont,1);
cc_V2_V2_cont(:,11)=mean(cc_V2_V2_1203d_cont,1);
cc_V2_V2_cont(:,12)=mean(cc_V2_V2_1203e_cont,1);
cc_V2_V2_cont(:,13)=mean(cc_V2_V2_1203f_cont,1);


cc_V2_V2_non(:,1)=mean(cc_V2_V2_1111c14_non,1);
cc_V2_V2_non(:,2)=mean(cc_V2_V2_1111c25_non,1);
cc_V2_V2_non(:,3)=mean(cc_V2_V2_1111d14_non,1);
cc_V2_V2_non(:,4)=mean(cc_V2_V2_1111d25_non,1);
cc_V2_V2_non(:,5)=mean(cc_V2_V2_1811c_non,1);
cc_V2_V2_non(:,6)=mean(cc_V2_V2_1811d_non,1);
cc_V2_V2_non(:,7)=mean(cc_V2_V2_1811e_non,1);
cc_V2_V2_non(:,8)=mean(cc_V2_V2_2511d_non,1);
cc_V2_V2_non(:,9)=mean(cc_V2_V2_2511e_non,1);
cc_V2_V2_non(:,10)=mean(cc_V2_V2_2511f_non,1);
cc_V2_V2_non(:,11)=mean(cc_V2_V2_1203d_non,1);
cc_V2_V2_non(:,12)=mean(cc_V2_V2_1203e_non,1);
cc_V2_V2_non(:,13)=mean(cc_V2_V2_1203f_non,1);




cc_circ_V22_cont(:,1)=mean(cc_circ_V22_1111c14_cont,1);
cc_circ_V22_cont(:,2)=mean(cc_circ_V22_1111c25_cont,1);
cc_circ_V22_cont(:,3)=mean(cc_circ_V22_1111d14_cont,1);
cc_circ_V22_cont(:,4)=mean(cc_circ_V22_1111d25_cont,1);
cc_circ_V22_cont(:,5)=mean(cc_circ_V22_1811c_cont,1);
cc_circ_V22_cont(:,6)=mean(cc_circ_V22_1811d_cont,1);
cc_circ_V22_cont(:,7)=mean(cc_circ_V22_1811e_cont,1);
cc_circ_V22_cont(:,8)=mean(cc_circ_V22_2511d_cont,1);
cc_circ_V22_cont(:,9)=mean(cc_circ_V22_2511e_cont,1);
cc_circ_V22_cont(:,10)=mean(cc_circ_V22_2511f_cont,1);
cc_circ_V22_cont(:,11)=mean(cc_circ_V22_1203d_cont,1);
cc_circ_V22_cont(:,12)=mean(cc_circ_V22_1203e_cont,1);
cc_circ_V22_cont(:,13)=mean(cc_circ_V22_1203f_cont,1);


cc_circ_V22_non(:,1)=mean(cc_circ_V22_1111c14_non,1);
cc_circ_V22_non(:,2)=mean(cc_circ_V22_1111c25_non,1);
cc_circ_V22_non(:,3)=mean(cc_circ_V22_1111d14_non,1);
cc_circ_V22_non(:,4)=mean(cc_circ_V22_1111d25_non,1);
cc_circ_V22_non(:,5)=mean(cc_circ_V22_1811c_non,1);
cc_circ_V22_non(:,6)=mean(cc_circ_V22_1811d_non,1);
cc_circ_V22_non(:,7)=mean(cc_circ_V22_1811e_non,1);
cc_circ_V22_non(:,8)=mean(cc_circ_V22_2511d_non,1);
cc_circ_V22_non(:,9)=mean(cc_circ_V22_2511e_non,1);
cc_circ_V22_non(:,10)=mean(cc_circ_V22_2511f_non,1);
cc_circ_V22_non(:,11)=mean(cc_circ_V22_1203d_non,1);
cc_circ_V22_non(:,12)=mean(cc_circ_V22_1203e_non,1);
cc_circ_V22_non(:,13)=mean(cc_circ_V22_1203f_non,1);


%% normalize


%substract minimum
cc_circ_V2_cont=cc_circ_V2_cont-repmat(mean(cc_circ_V2_cont(13:18,:),1),112,1);
cc_V2_V2_cont=cc_V2_V2_cont-repmat(mean(cc_V2_V2_cont(13:18,:),1),112,1);
cc_circ_circ_cont=cc_circ_circ_cont-repmat(mean(cc_circ_circ_cont(13:18,:),1),112,1);

cc_circ_V2_non=cc_circ_V2_non-repmat(mean(cc_circ_V2_non(13:18,:),1),112,1);
cc_V2_V2_non=cc_V2_V2_non-repmat(mean(cc_V2_V2_non(13:18,:),1),112,1);
cc_circ_circ_non=cc_circ_circ_non-repmat(mean(cc_circ_circ_non(13:18,:),1),112,1);


% divide by maximum peak
mm=max(cc_circ_circ_cont(23:43,:));

cc_circ_V2_cont_n=cc_circ_V2_cont./repmat(mm,112,1);
cc_V2_V2_cont_n=cc_V2_V2_cont./repmat(mm,112,1);
cc_circ_circ_cont_n=cc_circ_circ_cont./repmat(mm,112,1);

cc_circ_V2_non_n=cc_circ_V2_non./repmat(mm,112,1);
cc_V2_V2_non_n=cc_V2_V2_non./repmat(mm,112,1);
cc_circ_circ_non_n=cc_circ_circ_non./repmat(mm,112,1);



figure;plot(x,mean(cc_circ_circ_cont_n,2))
hold on
plot(x,mean(cc_circ_V2_cont_n,2),'g')
plot(x,mean(cc_V2_V2_cont_n,2),'r')

plot(x,mean(cc_circ_circ_non_n,2),'LineStyle','--')
plot(x,mean(cc_circ_V2_non_n,2),'Color','g','LineStyle','--')
plot(x,mean(cc_V2_V2_non_n,2),'Color','r','LineStyle','--')
xlim([-100 250])


figure;plot(x,mean(cc_circ_circ_cont_n-cc_circ_circ_non_n,2))
hold on
plot(x,mean(cc_circ_V2_cont_n-cc_circ_V2_non_n,2),'g')
plot(x,mean(cc_V2_V2_cont_n-cc_V2_V2_non_n,2),'r')
xlim([-100 250])

figure;plot(x,mean(cc_circ_circ_cont-cc_circ_circ_non,2))
hold on
plot(x,mean(cc_circ_V2_cont-cc_circ_V2_non,2),'g')
plot(x,mean(cc_V2_V2_cont-cc_V2_V2_non,2),'r')
xlim([-100 250])

for i=1:13
    figure;plot(x,mean(cc_circ_circ_cont_n(:,i),2))
    hold on
    plot(x,mean(cc_circ_V2_cont_n(:,i),2),'g')
    plot(x,mean(cc_V2_V2_cont_n(:,i),2),'r')

    plot(x,mean(cc_circ_circ_non_n(:,i),2),'LineStyle','--')
    plot(x,mean(cc_circ_V2_non_n(:,i),2),'Color','g','LineStyle','--')
    plot(x,mean(cc_V2_V2_non_n(:,i),2),'Color','r','LineStyle','--')
    xlim([-100 250])
end



for i=1:13
    figure;plot(x,mean(cc_circ_circ_cont(:,i),2))
    hold on
    plot(x,mean(cc_circ_V2_cont(:,i),2),'g')
    plot(x,mean(cc_V2_V2_cont(:,i),2),'r')

    plot(x,mean(cc_circ_circ_non(:,i),2),'LineStyle','--')
    plot(x,mean(cc_circ_V2_non(:,i),2),'Color','g','LineStyle','--')
    plot(x,mean(cc_V2_V2_non(:,i),2),'Color','r','LineStyle','--')
    xlim([-100 250])
end

for i=1:13
    figure;plot(x,mean(cc_circ_circ_cont(:,i)-cc_circ_circ_non(:,i),2))
    hold on
    plot(x,mean(cc_circ_V2_cont(:,i)-cc_circ_V2_non(:,i),2),'g')
    plot(x,mean(cc_V2_V2_cont(:,i)-cc_V2_V2_non(:,i),2),'r')
    plot(x,zeros(112,1),'k')
    xlim([150 250])
end

for i=1:112
    p1(i)=ranksum(cc_circ_circ_cont(i,:),cc_circ_circ_non(i,:));
    p2(i)=ranksum(cc_V2_V2_cont(i,:),cc_V2_V2_non(i,:));
    p3(i)=ranksum(cc_circ_V2_cont(i,:),cc_circ_V2_non(i,:));
end

for i=1:112
    p1(i)=ranksum(cc_circ_circ_cont(i,:)-cc_circ_circ_non(i,:),cc_circ_V2_cont(i,:)-cc_circ_V2_non(i,:));
    p2(i)=ranksum(cc_V2_V2_cont(i,:)-cc_V2_V2_non(i,:),cc_circ_V2_cont(i,:)-cc_circ_V2_non(i,:));
    p3(i)=ranksum(cc_V2_V2_cont(i,:)-cc_V2_V2_non(i,:),cc_circ_circ_cont(i,:)-cc_circ_circ_non(i,:));
end


x(find(p1<0.05))
x(find(p2<0.05))
x(find(p3<0.05))



%% unite for all pixels

cc_circ_V2_cont=cc_circ_V2_1111c14_cont;
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1111c25_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1111d14_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1111d25_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1811c_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1811d_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1811e_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_2511d_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_2511e_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_2511f_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1203d_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1203e_cont);
cc_circ_V2_cont=cat(1,cc_circ_V2_cont,cc_circ_V2_1203f_cont);

cc_circ_V2_non=cc_circ_V2_1111c14_non;
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1111c25_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1111d14_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1111d25_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1811c_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1811d_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1811e_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_2511d_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_2511e_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_2511f_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1203d_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1203e_non);
cc_circ_V2_non=cat(1,cc_circ_V2_non,cc_circ_V2_1203f_non);


cc_circ_circ_cont=cc_circ_circ_1111c14_cont;
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1111c25_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1111d14_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1111d25_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1811c_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1811d_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1811e_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_2511d_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_2511e_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_2511f_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1203d_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1203e_cont);
cc_circ_circ_cont=cat(1,cc_circ_circ_cont,cc_circ_circ_1203f_cont);

cc_circ_circ_non=cc_circ_circ_1111c14_non;
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1111c25_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1111d14_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1111d25_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1811c_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1811d_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1811e_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_2511d_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_2511e_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_2511f_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1203d_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1203e_non);
cc_circ_circ_non=cat(1,cc_circ_circ_non,cc_circ_circ_1203f_non);



cc_V2_V2_cont=cc_V2_V2_1111c14_cont;
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1111c25_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1111d14_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1111d25_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1811c_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1811d_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1811e_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_2511d_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_2511e_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_2511f_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1203d_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1203e_cont);
cc_V2_V2_cont=cat(1,cc_V2_V2_cont,cc_V2_V2_1203f_cont);

cc_V2_V2_non=cc_V2_V2_1111c14_non;
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1111c25_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1111d14_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1111d25_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1811c_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1811d_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1811e_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_2511d_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_2511e_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_2511f_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1203d_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1203e_non);
cc_V2_V2_non=cat(1,cc_V2_V2_non,cc_V2_V2_1203f_non);


cc_circ_V22_cont=cc_circ_V22_1111c14_cont;
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1111c25_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1111d14_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1111d25_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1811c_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1811d_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1811e_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_2511d_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_2511e_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_2511f_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1203d_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1203e_cont);
cc_circ_V22_cont=cat(1,cc_circ_V22_cont,cc_circ_V22_1203f_cont);

cc_circ_V22_non=cc_circ_V22_1111c14_non;
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1111c25_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1111d14_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1111d25_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1811c_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1811d_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1811e_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_2511d_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_2511e_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_2511f_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1203d_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1203e_non);
cc_circ_V22_non=cat(1,cc_circ_V22_non,cc_circ_V22_1203f_non);

figure;plot(x,mean(cc_circ_circ_cont-cc_circ_circ_non,1))
hold on
plot(x,mean(cc_circ_V2_cont-cc_circ_V2_non,1),'g')
plot(x,mean(cc_V2_V2_cont-cc_V2_V2_non,1),'r')
xlim([-100 250])


figure;errorbar(x,mean(cc_circ_circ_cont-cc_circ_circ_non,1),std(cc_circ_circ_cont-cc_circ_circ_non,0,1)/sqrt(10076))
hold on
errorbar(x,mean(cc_circ_V2_cont-cc_circ_V2_non,1),std(cc_circ_V2_cont-cc_circ_V2_non,0,1)/sqrt(10076),'g')
errorbar(x,mean(cc_V2_V2_cont-cc_V2_V2_non,1),std(cc_V2_V2_cont-cc_V2_V2_non,0,1)/sqrt(2300),'r')
xlim([-100 250])


figure;plot(x,mean(cc_circ_circ_cont,1))
hold on
plot(x,mean(cc_circ_V2_cont,1),'g')
plot(x,mean(cc_V2_V2_cont,1),'r')

plot(x,mean(cc_circ_circ_non,1),'LineStyle','--')
plot(x,mean(cc_circ_V2_non,1),'Color','g','LineStyle','--')
plot(x,mean(cc_V2_V2_non,1),'Color','r','LineStyle','--')
xlim([-100 250])


%normalize per pixel

%substract minimum
cc_circ_V2_cont=cc_circ_V2_cont-repmat(mean(cc_circ_V2_cont(:,1:20),2),1,112);
cc_V2_V2_cont=cc_V2_V2_cont-repmat(mean(cc_V2_V2_cont(:,1:20),2),1,112);
cc_circ_circ_cont=cc_circ_circ_cont-repmat(mean(cc_circ_circ_cont(:,1:20),2),1,112);

cc_circ_V2_non=cc_circ_V2_non-repmat(mean(cc_circ_V2_non(:,1:20),2),1,112);
cc_V2_V2_non=cc_V2_V2_non-repmat(mean(cc_V2_V2_non(:,1:20),2),1,112);
cc_circ_circ_non=cc_circ_circ_non-repmat(mean(cc_circ_circ_non(:,1:20),2),1,112);

% divide by maximum peak
mm=max(cc_circ_circ_cont(:,23:43),[],2);
cc_circ_circ_cont_n=(cc_circ_circ_cont./repmat(mm,1,112))';
cc_circ_circ_non_n=(cc_circ_circ_non./repmat(mm,1,112))';


mm=max(cc_circ_V2_cont(:,23:43),[],2);
cc_circ_V2_cont_n=(cc_circ_V2_cont./repmat(mm,1,112))';
cc_circ_V2_non_n=(cc_circ_V2_non./repmat(mm,1,112))';


mm=max(cc_V2_V2_cont(:,23:43),[],2);
cc_V2_V2_cont_n=(cc_V2_V2_cont./repmat(mm,1,112))';
cc_V2_V2_non_n=(cc_V2_V2_non./repmat(mm,1,112))';


for i=1:112
    p1(i)=ranksum(cc_circ_circ_cont(:,i),cc_circ_circ_non(:,i));
    p2(i)=ranksum(cc_V2_V2_cont(:,i),cc_V2_V2_non(:,i));
    p3(i)=ranksum(cc_circ_V2_cont(:,i),cc_circ_V2_non(:,i));
end


x(find(p1<0.001))
x(find(p2<0.001))
x(find(p3<0.001))






%%
figure;plot(x,mean(cc_circ_circ_1111c25_cont,1))
hold on
plot(x,mean(cc_circ_V2_1111c25_cont,1),'g')
plot(x,mean(cc_V2_V2_1111c25_cont,1),'r')

plot(x,mean(cc_circ_circ_1111c25_non,1),'LineStyle','--')
plot(x,mean(cc_circ_V2_1111c25_non,1),'Color','g','LineStyle','--')
plot(x,mean(cc_V2_V2_1111c25_non,1),'Color','r','LineStyle','--')
xlim([-100 250])


figure;plot(x,mean(cc_circ_circ_1111c25_cont-cc_circ_circ_1111c25_non,1))
hold on
plot(x,mean(cc_circ_V2_1111c25_cont-cc_circ_V2_1111c25_non,1),'g')
plot(x,mean(cc_V2_V2_1111c25_cont-cc_V2_V2_1111c25_non,1),'r')
xlim([-100 250])



for i=1:112
    p1(i)=ranksum(cc_circ_circ_1111c25_cont(:,i),cc_circ_circ_1111c25_non(:,i));
    p2(i)=ranksum(cc_V2_V2_1111c25_cont(:,i),cc_V2_V2_1111c25_non(:,i));
    p3(i)=ranksum(cc_circ_V2_1111c25_cont(:,i),cc_circ_V2_1111c25_non(:,i));
end


x(find(p1<0.0001))
x(find(p2<0.0001))
x(find(p3<0.0001))

time=31:34;
a=mean(cc_circ_circ_1203f_cont(:,time)-cc_circ_circ_1203f_non(:,time),2);
b=mean(cc_circ_V2_1203f_cont(:,time)-cc_circ_V2_1203f_non(:,time),2);
c=mean(cc_V2_V2_1203f_cont(:,time)-cc_V2_V2_1203f_non(:,time),2);
figure;bar([mean(a),mean(b),mean(c)])
hold on
errorbar([mean(a),mean(b),mean(c)],[std(a)/sqrt(size(a,1)),std(b)/sqrt(size(b,1)),std(c)/sqrt(size(c,1))])
ranksum(a,b)
ranksum(a,c)
ranksum(c,b)


time=42:45;
a=mean(cc_circ_circ_1203f_cont(:,time)-cc_circ_circ_1203f_non(:,time),2);
b=mean(cc_circ_V2_1203f_cont(:,time)-cc_circ_V2_1203f_non(:,time),2);
c=mean(cc_V2_V2_1203f_cont(:,time)-cc_V2_V2_1203f_non(:,time),2);
figure;bar([mean(a),mean(b),mean(c)])
hold on
errorbar([mean(a),mean(b),mean(c)],[std(a)/sqrt(size(a,1)),std(b)/sqrt(size(b,1)),std(c)/sqrt(size(c,1))])
ranksum(a,b)
ranksum(a,c)
ranksum(c,b)













time=31:34;
a=mean(cc_circ_circ_cont(:,time)-cc_circ_circ_non(:,time),2);
b=mean(cc_circ_V2_cont(:,time)-cc_circ_V2_non(:,time),2);
c=mean(cc_V2_V2_cont(:,time)-cc_V2_V2_non(:,time),2);
figure;bar([mean(a),mean(b),mean(c)])
hold on
errorbar([mean(a),mean(b),mean(c)],[std(a)/sqrt(size(a,1)),std(b)/sqrt(size(b,1)),std(c)/sqrt(size(c,1))])
ranksum(a,b)
ranksum(a,c)
ranksum(c,b)


time=42:45;
a=mean(cc_circ_circ_cont(:,time)-cc_circ_circ_non(:,time),2);
b=mean(cc_circ_V2_cont(:,time)-cc_circ_V2_non(:,time),2);
c=mean(cc_V2_V2_cont(:,time)-cc_V2_V2_non(:,time),2);
figure;bar([mean(a),mean(b),mean(c)])
hold on
errorbar([mean(a),mean(b),mean(c)],[std(a)/sqrt(size(a,1)),std(b)/sqrt(size(b,1)),std(c)/sqrt(size(c,1))])
ranksum(a,b)
ranksum(a,c)
ranksum(c,b)





time=42:45;
figure;bar([mean(mean(cc_circ_circ(time,1:13))),mean(mean(cc_circ_V2(time,:))),mean(mean(cc_V2_V2(time,:)))])
hold on
errorbar([mean(mean(cc_circ_circ(time,1:13))),mean(mean(cc_circ_V2(time,:))),mean(mean(cc_V2_V2(time,:)))],[std(mean(cc_circ_circ(time,:)))/sqrt(size(cc_circ_circ,2)),std(mean(cc_circ_V2(time,:)))/sqrt(size(cc_circ_V2,2)),std(mean(cc_V2_V2(time,:)))/sqrt(size(cc_V2_V2,2))])


signrank(mean(cc_circ_circ(time,1:13)))
signrank(mean(cc_circ_V2(time,1:13)))
signrank(mean(cc_V2_V2(time,1:13)))



for i=9
   figure;plot(x,cc_circ_V2_cont(:,i))
   hold on
   plot(x,cc_circ_V22_cont(:,i),'r')
end

