%% 0812

%c
load myrois2

c1_0812c_cccirc_circ=squeeze(mean(a(roi_circle14,:,:),1));
c1_0812c_cccirc_bg=squeeze(mean(a(roi_bg_in14,:,:),1));
c4_0812c_cccirc_circ=squeeze(mean(b(roi_circle14,:,:),1));
c4_0812c_cccirc_bg=squeeze(mean(b(roi_bg_in14,:,:),1));
c2_0812c_cccirc_circ=squeeze(mean(a(roi_circle25,:,:),1));
c2_0812c_cccirc_bg=squeeze(mean(a(roi_bg_out25,:,:),1));
c5_0812c_cccirc_circ=squeeze(mean(b(roi_circle25,:,:),1));
c5_0812c_cccirc_bg=squeeze(mean(b(roi_bg_out25,:,:),1));


c1_0812c_ccbg_bg=squeeze(mean(a(roi_bg_in14,:,:),1));
c4_0812c_ccbg_bg=squeeze(mean(b(roi_bg_in14,:,:),1));
c2_0812c_ccbg_bg=squeeze(mean(a(roi_bg_out25,:,:),1));
c5_0812c_ccbg_bg=squeeze(mean(b(roi_bg_out25,:,:),1));

%e
load myrois2

c1_0812e_cccirc_circ=squeeze(mean(a(roi_circle14,:,:),1));
c1_0812e_cccirc_bg=squeeze(mean(a(roi_bg_in14,:,:),1));
c4_0812e_cccirc_circ=squeeze(mean(b(roi_circle14,:,:),1));
c4_0812e_cccirc_bg=squeeze(mean(b(roi_bg_in14,:,:),1));
c2_0812e_cccirc_circ=squeeze(mean(a(roi_circle25,:,:),1));
c2_0812e_cccirc_bg=squeeze(mean(a(roi_bg_out25,:,:),1));
c5_0812e_cccirc_circ=squeeze(mean(b(roi_circle25,:,:),1));
c5_0812e_cccirc_bg=squeeze(mean(b(roi_bg_out25,:,:),1));


c1_0812e_ccbg_bg=squeeze(mean(a(roi_bg_in14,:,:),1));
c4_0812e_ccbg_bg=squeeze(mean(b(roi_bg_in14,:,:),1));
c2_0812e_ccbg_bg=squeeze(mean(a(roi_bg_out25,:,:),1));
c5_0812e_ccbg_bg=squeeze(mean(b(roi_bg_out25,:,:),1));



%% 1512

%b
load myrois2

c1_1512b_cccirc_circ=squeeze(mean(a(roi_circle,:,:),1));
c1_1512b_cccirc_bg=squeeze(mean(a(roi_bg,:,:),1));
c2_1512b_cccirc_circ=squeeze(mean(b(roi_circle,:,:),1));
c2_1512b_cccirc_bg=squeeze(mean(b(roi_bg,:,:),1));
c4_1512b_cccirc_circ=squeeze(mean(c(roi_circle,:,:),1));
c4_1512b_cccirc_bg=squeeze(mean(c(roi_bg,:,:),1));
c5_1512b_cccirc_circ=squeeze(mean(d(roi_circle,:,:),1));
c5_1512b_cccirc_bg=squeeze(mean(d(roi_bg,:,:),1));


c1_1512b_ccbg_bg=squeeze(mean(a(roi_bg,:,:),1));
c2_1512b_ccbg_bg=squeeze(mean(b(roi_bg,:,:),1));
c4_1512b_ccbg_bg=squeeze(mean(c(roi_bg,:,:),1));
c5_1512b_ccbg_bg=squeeze(mean(d(roi_bg,:,:),1));


%c
load myrois2

c1_1512c_cccirc_circ=squeeze(mean(a(roi_circle,:,:),1));
c1_1512c_cccirc_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_1512c_cccirc_circ=squeeze(mean(b(roi_circle,:,:),1));
c2_1512c_cccirc_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_1512c_cccirc_circ=squeeze(mean(c(roi_circle,:,:),1));
c4_1512c_cccirc_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_1512c_cccirc_circ=squeeze(mean(d(roi_circle,:,:),1));
c5_1512c_cccirc_bg=squeeze(mean(d(roi_bg_out,:,:),1));


c1_1512c_ccbg_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_1512c_ccbg_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_1512c_ccbg_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_1512c_ccbg_bg=squeeze(mean(d(roi_bg_out,:,:),1));


%% 2812
%b
load myrois2

c1_2812b_cccirc_circ=squeeze(mean(a(roi_circle,:,:),1));
c1_2812b_cccirc_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812b_cccirc_circ=squeeze(mean(b(roi_circle,:,:),1));
c2_2812b_cccirc_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812b_cccirc_circ=squeeze(mean(c(roi_circle,:,:),1));
c4_2812b_cccirc_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812b_cccirc_circ=squeeze(mean(d(roi_circle,:,:),1));
c5_2812b_cccirc_bg=squeeze(mean(d(roi_bg_out,:,:),1));


c1_2812b_ccbg_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812b_ccbg_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812b_ccbg_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812b_ccbg_bg=squeeze(mean(d(roi_bg_out,:,:),1));


%c
load myrois2

c1_2812c_cccirc_circ=squeeze(mean(a(roi_circle,:,:),1));
c1_2812c_cccirc_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812c_cccirc_circ=squeeze(mean(b(roi_circle,:,:),1));
c2_2812c_cccirc_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812c_cccirc_circ=squeeze(mean(c(roi_circle,:,:),1));
c4_2812c_cccirc_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812c_cccirc_circ=squeeze(mean(d(roi_circle,:,:),1));
c5_2812c_cccirc_bg=squeeze(mean(d(roi_bg_out,:,:),1));


c1_2812c_ccbg_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812c_ccbg_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812c_ccbg_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812c_ccbg_bg=squeeze(mean(d(roi_bg_out,:,:),1));

%d
load myrois2

c1_2812d_cccirc_circ=squeeze(mean(a(roi_circle,:,:),1));
c1_2812d_cccirc_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812d_cccirc_circ=squeeze(mean(b(roi_circle,:,:),1));
c2_2812d_cccirc_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812d_cccirc_circ=squeeze(mean(c(roi_circle,:,:),1));
c4_2812d_cccirc_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812d_cccirc_circ=squeeze(mean(d(roi_circle,:,:),1));
c5_2812d_cccirc_bg=squeeze(mean(d(roi_bg_out,:,:),1));


c1_2812d_ccbg_bg=squeeze(mean(a(roi_bg_out,:,:),1));
c2_2812d_ccbg_bg=squeeze(mean(b(roi_bg_out,:,:),1));
c4_2812d_ccbg_bg=squeeze(mean(c(roi_bg_out,:,:),1));
c5_2812d_ccbg_bg=squeeze(mean(d(roi_bg_out,:,:),1));



%%

cont_cccirc_circ(:,1)=mean(c1_0812c_cccirc_circ,2);
cont_cccirc_circ(:,2)=mean(c2_0812c_cccirc_circ,2);
cont_cccirc_circ(:,3)=mean(c1_0812e_cccirc_circ,2);
cont_cccirc_circ(:,4)=mean(c2_0812e_cccirc_circ,2);
cont_cccirc_circ(:,5)=mean(c1_1512b_cccirc_circ,2);
cont_cccirc_circ(:,6)=mean(c2_1512b_cccirc_circ,2);
cont_cccirc_circ(:,7)=mean(c1_1512c_cccirc_circ,2);
cont_cccirc_circ(:,8)=mean(c2_1512c_cccirc_circ,2);
cont_cccirc_circ(:,9)=mean(c1_2812b_cccirc_circ,2);
cont_cccirc_circ(:,10)=mean(c1_2812c_cccirc_circ,2);
cont_cccirc_circ(:,11)=mean(c1_2812d_cccirc_circ,2);

non_cccirc_circ(:,1)=mean(c4_0812c_cccirc_circ,2);
non_cccirc_circ(:,2)=mean(c5_0812c_cccirc_circ,2);
non_cccirc_circ(:,3)=mean(c4_0812e_cccirc_circ,2);
non_cccirc_circ(:,4)=mean(c5_0812e_cccirc_circ,2);
non_cccirc_circ(:,5)=mean(c4_1512b_cccirc_circ,2);
non_cccirc_circ(:,6)=mean(c5_1512b_cccirc_circ,2);
non_cccirc_circ(:,7)=mean(c4_1512c_cccirc_circ,2);
non_cccirc_circ(:,8)=mean(c5_1512c_cccirc_circ,2);
non_cccirc_circ(:,9)=mean(c5_2812b_cccirc_circ,2);
non_cccirc_circ(:,10)=mean(c5_2812c_cccirc_circ,2);
non_cccirc_circ(:,11)=mean(c5_2812d_cccirc_circ,2);


cont_cccirc_bg(:,1)=mean(c1_0812c_cccirc_bg,2);
cont_cccirc_bg(:,2)=mean(c2_0812c_cccirc_bg,2);
cont_cccirc_bg(:,3)=mean(c1_0812e_cccirc_bg,2);
cont_cccirc_bg(:,4)=mean(c2_0812e_cccirc_bg,2);
cont_cccirc_bg(:,5)=mean(c1_1512b_cccirc_bg,2);
cont_cccirc_bg(:,6)=mean(c2_1512b_cccirc_bg,2);
cont_cccirc_bg(:,7)=mean(c1_1512c_cccirc_bg,2);
cont_cccirc_bg(:,8)=mean(c2_1512c_cccirc_bg,2);
cont_cccirc_bg(:,9)=mean(c1_2812b_cccirc_bg,2);
cont_cccirc_bg(:,10)=mean(c1_2812c_cccirc_bg,2);
cont_cccirc_bg(:,11)=mean(c1_2812d_cccirc_bg,2);

non_cccirc_bg(:,1)=mean(c4_0812c_cccirc_bg,2);
non_cccirc_bg(:,2)=mean(c5_0812c_cccirc_bg,2);
non_cccirc_bg(:,3)=mean(c4_0812e_cccirc_bg,2);
non_cccirc_bg(:,4)=mean(c5_0812e_cccirc_bg,2);
non_cccirc_bg(:,5)=mean(c4_1512b_cccirc_bg,2);
non_cccirc_bg(:,6)=mean(c5_1512b_cccirc_bg,2);
non_cccirc_bg(:,7)=mean(c4_1512c_cccirc_bg,2);
non_cccirc_bg(:,8)=mean(c5_1512c_cccirc_bg,2);
non_cccirc_bg(:,9)=mean(c5_2812b_cccirc_bg,2);
non_cccirc_bg(:,10)=mean(c5_2812c_cccirc_bg,2);
non_cccirc_bg(:,11)=mean(c5_2812d_cccirc_bg,2);


cont_ccbg_bg(:,1)=mean(c1_0812c_ccbg_bg,2);
cont_ccbg_bg(:,2)=mean(c2_0812c_ccbg_bg,2);
cont_ccbg_bg(:,3)=mean(c1_0812e_ccbg_bg,2);
cont_ccbg_bg(:,4)=mean(c2_0812e_ccbg_bg,2);
cont_ccbg_bg(:,5)=mean(c1_1512b_ccbg_bg,2);
cont_ccbg_bg(:,6)=mean(c2_1512b_ccbg_bg,2);
cont_ccbg_bg(:,7)=mean(c1_1512c_ccbg_bg,2);
cont_ccbg_bg(:,8)=mean(c2_1512c_ccbg_bg,2);
cont_ccbg_bg(:,9)=mean(c1_2812b_ccbg_bg,2);
cont_ccbg_bg(:,10)=mean(c1_2812c_ccbg_bg,2);
cont_ccbg_bg(:,11)=mean(c1_2812d_ccbg_bg,2);

non_ccbg_bg(:,1)=mean(c4_0812c_ccbg_bg,2);
non_ccbg_bg(:,2)=mean(c5_0812c_ccbg_bg,2);
non_ccbg_bg(:,3)=mean(c4_0812e_ccbg_bg,2);
non_ccbg_bg(:,4)=mean(c5_0812e_ccbg_bg,2);
non_ccbg_bg(:,5)=mean(c4_1512b_ccbg_bg,2);
non_ccbg_bg(:,6)=mean(c5_1512b_ccbg_bg,2);
non_ccbg_bg(:,7)=mean(c4_1512c_ccbg_bg,2);
non_ccbg_bg(:,8)=mean(c5_1512c_ccbg_bg,2);
non_ccbg_bg(:,9)=mean(c5_2812b_ccbg_bg,2);
non_ccbg_bg(:,10)=mean(c5_2812c_ccbg_bg,2);
non_ccbg_bg(:,11)=mean(c5_2812d_ccbg_bg,2);


diff_cccirc_circ=cont_cccirc_circ-non_cccirc_circ;
diff_cccirc_bg=cont_cccirc_bg-non_cccirc_bg;
diff_ccbg_bg=cont_ccbg_bg-non_ccbg_bg;

diff_fg=diff_cccirc_circ-diff_ccbg_bg;

x=(20:10:1130)-240;
figure;errorbar(x,mean(diff_cccirc_circ,2),std(diff_cccirc_circ,0,2)/sqrt(size(diff_cccirc_circ,2)))
hold on
errorbar(x,mean(diff_ccbg_bg,2),std(diff_ccbg_bg,0,2)/sqrt(size(diff_ccbg_bg,2)),'r')
%errorbar(x,mean(diff_cccirc_bg,2),std(diff_cccirc_bg,0,2)/sqrt(size(diff_cccirc_bg,2)),'g')
plot(x,zeros(1,112),'k')
xlim([-100 300])

figure;errorbar(x,mean(diff_fg,2),std(diff_fg,0,2)/sqrt(size(diff_fg,2)))
hold on
plot(x,zeros(1,112),'k')
xlim([-100 300])

signrank(mean(diff_fg(28:33,:),2))






