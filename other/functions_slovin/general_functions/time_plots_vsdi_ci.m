%% plot vsdi in time

%contour integration

time_circ_cont_1111c=mean(a(roi_contour2,:),1);
time_circ_non_1111c=mean(b(roi_contour2,:),1);
time_circ_blank_1111c=mean(c(roi_contour2,:),1);

time_bgi_cont_1111c=mean(a(roi_maskin,:),1);
time_bgi_non_1111c=mean(b(roi_maskin,:),1);
time_bgi_blank_1111c=mean(c(roi_maskin,:),1);


time_circ_cont_1111d=mean(a(roi_contour2,:),1);
time_circ_non_1111d=mean(b(roi_contour2,:),1);
time_circ_blank_1111d=mean(c(roi_contour2,:),1);

time_bgi_cont_1111d=mean(a(roi_maskin,:),1);
time_bgi_non_1111d=mean(b(roi_maskin,:),1);
time_bgi_blank_1111d=mean(c(roi_maskin,:),1);


time_circ_cont_1111h=mean(a(roi_contour,:),1);
time_circ_non_1111h=mean(b(roi_contour,:),1);
time_circ_blank_1111h=mean(c(roi_contour,:),1);

time_bgi_cont_1111h=mean(a(roi_maskin,:),1);
time_bgi_non_1111h=mean(b(roi_maskin,:),1);
time_bgi_blank_1111h=mean(c(roi_maskin,:),1);


time_circ_cont_1811c=mean(a(roi_contour,:),1);
time_circ_non_1811c=mean(d(roi_contour,:),1);
time_circ_blank_1811c=mean(e(roi_contour,:),1);

time_bgi_cont_1811c=mean(a(roi_bg_in,:),1);
time_bgi_non_1811c=mean(d(roi_bg_in,:),1);
time_bgi_blank_1811c=mean(e(roi_bg_in,:),1);


time_circ_cont_1811d=mean(a(roi_contour,:),1);
time_circ_non_1811d=mean(d(roi_contour,:),1);
time_circ_blank_1811d=mean(e(roi_contour,:),1);

time_bgi_cont_1811d=mean(a(roi_bg_in,:),1);
time_bgi_non_1811d=mean(d(roi_bg_in,:),1);
time_bgi_blank_1811d=mean(e(roi_bg_in,:),1);


time_circ_cont_1811e=mean(a(roi_contour,:),1);
time_circ_non_1811e=mean(d(roi_contour,:),1);
time_circ_blank_1811e=mean(e(roi_contour,:),1);

time_bgi_cont_1811e=mean(a(roi_bg_in,:),1);
time_bgi_non_1811e=mean(d(roi_bg_in,:),1);
time_bgi_blank_1811e=mean(e(roi_bg_in,:),1);


time_circ_cont_2511d=mean(a(roi_contour,:),1);
time_circ_non_2511d=mean(d(roi_contour,:),1);
time_circ_blank_2511d=mean(e(roi_contour,:),1);

time_bgi_cont_2511d=mean(a(roi_bg_in,:),1);
time_bgi_non_2511d=mean(d(roi_bg_in,:),1);
time_bgi_blank_2511d=mean(e(roi_bg_in,:),1);


time_circ_cont_2511e=mean(a(roi_contour,:),1);
time_circ_non_2511e=mean(d(roi_contour,:),1);
time_circ_blank_2511e=mean(e(roi_contour,:),1);

time_bgi_cont_2511e=mean(a(roi_bg_in,:),1);
time_bgi_non_2511e=mean(d(roi_bg_in,:),1);
time_bgi_blank_2511e=mean(e(roi_bg_in,:),1);


time_circ_cont_2511f=mean(a(roi_contour,:),1);
time_circ_non_2511f=mean(d(roi_contour,:),1);
time_circ_blank_2511f=mean(e(roi_contour,:),1);

time_bgi_cont_2511f=mean(a(roi_bg_in,:),1);
time_bgi_non_2511f=mean(d(roi_bg_in,:),1);
time_bgi_blank_2511f=mean(e(roi_bg_in,:),1);


time_circ_cont_1203d=mean(a(roi_contour,:),1);
time_circ_non_1203d=mean(d(roi_contour,:),1);
time_circ_blank_1203d=mean(e(roi_contour,:),1);

time_bgi_cont_1203d=mean(a(roi_bg_in,:),1);
time_bgi_non_1203d=mean(d(roi_bg_in,:),1);
time_bgi_blank_1203d=mean(e(roi_bg_in,:),1);


time_circ_cont_1203e=mean(a(roi_contour,:),1);
time_circ_non_1203e=mean(d(roi_contour,:),1);
time_circ_blank_1203e=mean(e(roi_contour,:),1);

time_bgi_cont_1203e=mean(a(roi_bg_in,:),1);
time_bgi_non_1203e=mean(d(roi_bg_in,:),1);
time_bgi_blank_1203e=mean(e(roi_bg_in,:),1);


time_circ_cont_1203f=mean(a(roi_contour,:),1);
time_circ_non_1203f=mean(d(roi_contour,:),1);
time_circ_blank_1203f=mean(e(roi_contour,:),1);

time_bgi_cont_1203f=mean(a(roi_bg_in,:),1);
time_bgi_non_1203f=mean(d(roi_bg_in,:),1);
time_bgi_blank_1203f=mean(e(roi_bg_in,:),1);


time_circ_cont_0610e=mean(a(roi_contour,:),1);
time_circ_non_0610e=mean(b(roi_contour,:),1);
time_circ_blank_0610e=mean(c(roi_contour,:),1);

time_bgi_cont_0610e=mean(a(roi_bg_in,:),1);
time_bgi_non_0610e=mean(b(roi_bg_in,:),1);
time_bgi_blank_0610e=mean(c(roi_bg_in,:),1);


time_circ_cont_0610f=mean(a(roi_contour,:),1);
time_circ_non_0610f=mean(b(roi_contour,:),1);
time_circ_blank_0610f=mean(c(roi_contour,:),1);

time_bgi_cont_0610f=mean(a(roi_bg_in,:),1);
time_bgi_non_0610f=mean(b(roi_bg_in,:),1);
time_bgi_blank_0610f=mean(c(roi_bg_in,:),1);



time_circ_cont_2210d=mean(a(roi_contour,:),1);
time_circ_non_2210d=mean(b(roi_contour,:),1);
time_circ_blank_2210d=mean(c(roi_contour,:),1);

time_bgi_cont_2210d=mean(a(roi_bg_in,:),1);
time_bgi_non_2210d=mean(b(roi_bg_in,:),1);
time_bgi_blank_2210d=mean(c(roi_bg_in,:),1);


time_circ_cont_2210e=mean(a(roi_contour,:),1);
time_circ_non_2210e=mean(b(roi_contour,:),1);
time_circ_blank_2210e=mean(c(roi_contour,:),1);

time_bgi_cont_2210e=mean(a(roi_bg_in,:),1);
time_bgi_non_2210e=mean(b(roi_bg_in,:),1);
time_bgi_blank_2210e=mean(c(roi_bg_in,:),1);


time_circ_cont_0601e=mean(a(roi_contour,:),1);
time_circ_non_0601e=mean(b(roi_contour,:),1);
time_circ_blank_0601e=mean(c(roi_contour,:),1);

time_bgi_cont_0601e=mean(a(roi_bg_in,:),1);
time_bgi_non_0601e=mean(b(roi_bg_in,:),1);
time_bgi_blank_0601e=mean(c(roi_bg_in,:),1);


time_circ_cont_0601fg=mean(a(roi_contour2,:),1);
time_circ_non_0601fg=mean(b(roi_contour2,:),1);
time_circ_blank_0601fg=mean(c(roi_contour2,:),1);

time_bgi_cont_0601fg=mean(a(roi_bg_in,:),1);
time_bgi_non_0601fg=mean(b(roi_bg_in,:),1);
time_bgi_blank_0601fg=mean(c(roi_bg_in,:),1);


time_circ_cont(:,1)=time_circ_cont_1111c;
time_circ_cont(:,2)=time_circ_cont_1111d;
time_circ_cont(:,3)=time_circ_cont_1111h;
time_circ_cont(:,4)=time_circ_cont_1811c;
time_circ_cont(:,5)=time_circ_cont_1811d;
time_circ_cont(:,6)=time_circ_cont_1811e;
time_circ_cont(:,7)=time_circ_cont_2511d;
time_circ_cont(:,8)=time_circ_cont_2511e;
time_circ_cont(:,9)=time_circ_cont_2511f;
time_circ_cont(:,10)=time_circ_cont_1203d;
time_circ_cont(:,11)=time_circ_cont_1203e;
time_circ_cont(:,12)=time_circ_cont_1203f;
time_circ_cont(:,13)=time_circ_cont_0610e;
time_circ_cont(:,14)=time_circ_cont_0610f;
time_circ_cont(:,15)=time_circ_cont_2210d;
time_circ_cont(:,16)=time_circ_cont_2210e;
time_circ_cont(:,17)=time_circ_cont_0601e;
time_circ_cont(:,18)=time_circ_cont_0601fg;

time_circ_non(:,1)=time_circ_non_1111c;
time_circ_non(:,2)=time_circ_non_1111d;
time_circ_non(:,3)=time_circ_non_1111h;
time_circ_non(:,4)=time_circ_non_1811c;
time_circ_non(:,5)=time_circ_non_1811d;
time_circ_non(:,6)=time_circ_non_1811e;
time_circ_non(:,7)=time_circ_non_2511d;
time_circ_non(:,8)=time_circ_non_2511e;
time_circ_non(:,9)=time_circ_non_2511f;
time_circ_non(:,10)=time_circ_non_1203d;
time_circ_non(:,11)=time_circ_non_1203e;
time_circ_non(:,12)=time_circ_non_1203f;
time_circ_non(:,13)=time_circ_non_0610e;
time_circ_non(:,14)=time_circ_non_0610f;
time_circ_non(:,15)=time_circ_non_2210d;
time_circ_non(:,16)=time_circ_non_2210e;
time_circ_non(:,17)=time_circ_non_0601e;
time_circ_non(:,18)=time_circ_non_0601fg;


time_circ_blank(:,1)=time_circ_blank_1111c;
time_circ_blank(:,2)=time_circ_blank_1111d;
time_circ_blank(:,3)=time_circ_blank_1111h;
time_circ_blank(:,4)=time_circ_blank_1811c;
time_circ_blank(:,5)=time_circ_blank_1811d;
time_circ_blank(:,6)=time_circ_blank_1811e;
time_circ_blank(:,7)=time_circ_blank_2511d;
time_circ_blank(:,8)=time_circ_blank_2511e;
time_circ_blank(:,9)=time_circ_blank_2511f;
time_circ_blank(:,10)=time_circ_blank_1203d;
time_circ_blank(:,11)=time_circ_blank_1203e;
time_circ_blank(:,12)=time_circ_blank_1203f;
time_circ_blank(:,13)=time_circ_blank_0610e;
time_circ_blank(:,14)=time_circ_blank_0610f;
time_circ_blank(:,15)=time_circ_blank_2210d;
time_circ_blank(:,16)=time_circ_blank_2210e;
time_circ_blank(:,17)=time_circ_blank_0601e;
time_circ_blank(:,18)=time_circ_blank_0601fg;



x6=(1:256)*10-280;

figure
errorbar(x6,mean(time_circ_cont-1,2),std(time_circ_cont-1,0,2)/sqrt(18))
hold on
errorbar(x6,mean(time_circ_non-1,2),std(time_circ_non-1,0,2)/sqrt(18),'r')
errorbar(x6,mean(time_circ_blank-1,2),std(time_circ_blank-1,0,2)/sqrt(18),'g')
xlim([-200 300])


time_bgi_cont(:,1)=time_bgi_cont_1111c;
time_bgi_cont(:,2)=time_bgi_cont_1111d;
time_bgi_cont(:,3)=time_bgi_cont_1111h;
time_bgi_cont(:,4)=time_bgi_cont_1811c;
time_bgi_cont(:,5)=time_bgi_cont_1811d;
time_bgi_cont(:,6)=time_bgi_cont_1811e;
time_bgi_cont(:,7)=time_bgi_cont_2511d;
time_bgi_cont(:,8)=time_bgi_cont_2511e;
time_bgi_cont(:,9)=time_bgi_cont_2511f;
time_bgi_cont(:,10)=time_bgi_cont_1203d;
time_bgi_cont(:,11)=time_bgi_cont_1203e;
time_bgi_cont(:,12)=time_bgi_cont_1203f;
time_bgi_cont(:,13)=time_bgi_cont_0610e;
time_bgi_cont(:,14)=time_bgi_cont_0610f;
time_bgi_cont(:,15)=time_bgi_cont_2210d;
time_bgi_cont(:,16)=time_bgi_cont_2210e;
time_bgi_cont(:,17)=time_bgi_cont_0601e;
time_bgi_cont(:,18)=time_bgi_cont_0601fg;

time_bgi_non(:,1)=time_bgi_non_1111c;
time_bgi_non(:,2)=time_bgi_non_1111d;
time_bgi_non(:,3)=time_bgi_non_1111h;
time_bgi_non(:,4)=time_bgi_non_1811c;
time_bgi_non(:,5)=time_bgi_non_1811d;
time_bgi_non(:,6)=time_bgi_non_1811e;
time_bgi_non(:,7)=time_bgi_non_2511d;
time_bgi_non(:,8)=time_bgi_non_2511e;
time_bgi_non(:,9)=time_bgi_non_2511f;
time_bgi_non(:,10)=time_bgi_non_1203d;
time_bgi_non(:,11)=time_bgi_non_1203e;
time_bgi_non(:,12)=time_bgi_non_1203f;
time_bgi_non(:,13)=time_bgi_non_0610e;
time_bgi_non(:,14)=time_bgi_non_0610f;
time_bgi_non(:,15)=time_bgi_non_2210d;
time_bgi_non(:,16)=time_bgi_non_2210e;
time_bgi_non(:,17)=time_bgi_non_0601e;
time_bgi_non(:,18)=time_bgi_non_0601fg;


time_bgi_blank(:,1)=time_bgi_blank_1111c;
time_bgi_blank(:,2)=time_bgi_blank_1111d;
time_bgi_blank(:,3)=time_bgi_blank_1111h;
time_bgi_blank(:,4)=time_bgi_blank_1811c;
time_bgi_blank(:,5)=time_bgi_blank_1811d;
time_bgi_blank(:,6)=time_bgi_blank_1811e;
time_bgi_blank(:,7)=time_bgi_blank_2511d;
time_bgi_blank(:,8)=time_bgi_blank_2511e;
time_bgi_blank(:,9)=time_bgi_blank_2511f;
time_bgi_blank(:,10)=time_bgi_blank_1203d;
time_bgi_blank(:,11)=time_bgi_blank_1203e;
time_bgi_blank(:,12)=time_bgi_blank_1203f;
time_bgi_blank(:,13)=time_bgi_blank_0610e;
time_bgi_blank(:,14)=time_bgi_blank_0610f;
time_bgi_blank(:,15)=time_bgi_blank_2210d;
time_bgi_blank(:,16)=time_bgi_blank_2210e;
time_bgi_blank(:,17)=time_bgi_blank_0601e;
time_bgi_blank(:,18)=time_bgi_blank_0601fg;




x6=(1:256)*10-280;
bgi=[mean(time_bgi_cont(32:42,:),1);mean(time_bgi_non(32:42,:),1)];
circ=[mean(time_circ_cont(32:42,:),1);mean(time_circ_non(32:42,:),1)];
act=[bgi;circ];
figure;bar(mean(act-1,2))
hold on
errorbar(mean(act-1,2),std(act-1,0,2)/sqrt(18))


ranksum(act(1,:),act(2,:))
ranksum(act(1,:),act(3,:))
ranksum(act(2,:),act(3,:))
ranksum(act(2,:),act(4,:))



%% V2 area
time_V2_cont_1111c14=mean(a(roi_V2,:),1);
time_V2_non_1111c14=mean(b(roi_V2,:),1);
time_V2_blank_1111c14=mean(c(roi_V2,:),1);

time_V2_cont_1111c25=mean(a(roi_V2,:),1);
time_V2_non_1111c25=mean(b(roi_V2,:),1);
time_V2_blank_1111c25=mean(c(roi_V2,:),1);

time_V2_cont_1111d14=mean(a(roi_V2,:),1);
time_V2_non_1111d14=mean(b(roi_V2,:),1);
time_V2_blank_1111d14=mean(c(roi_V2,:),1);

time_V2_cont_1111d25=mean(a(roi_V2,:),1);
time_V2_non_1111d25=mean(b(roi_V2,:),1);
time_V2_blank_1111d25=mean(c(roi_V2,:),1);


time_V2_cont_1811c=mean(a(roi_V2,:),1);
time_V2_non_1811c=mean(d(roi_V2,:),1);
time_V2_blank_1811c=mean(e(roi_V2,:),1);

time_V2_cont_1811d=mean(a(roi_V2,:),1);
time_V2_non_1811d=mean(d(roi_V2,:),1);
time_V2_blank_1811d=mean(e(roi_V2,:),1);

time_V2_cont_1811e=mean(a(roi_V2,:),1);
time_V2_non_1811e=mean(d(roi_V2,:),1);
time_V2_blank_1811e=mean(e(roi_V2,:),1);


time_V2_cont_2511d=mean(a(roi_V2,:),1);
time_V2_non_2511d=mean(d(roi_V2,:),1);
time_V2_blank_2511d=mean(e(roi_V2,:),1);

time_V2_cont_2511e=mean(a(roi_V2,:),1);
time_V2_non_2511e=mean(d(roi_V2,:),1);
time_V2_blank_2511e=mean(e(roi_V2,:),1);

time_V2_cont_2511f=mean(a(roi_V2,:),1);
time_V2_non_2511f=mean(d(roi_V2,:),1);
time_V2_blank_2511f=mean(e(roi_V2,:),1);


time_V2_cont_1203d=mean(a(roi_V2,:),1);
time_V2_non_1203d=mean(d(roi_V2,:),1);
time_V2_blank_1203d=mean(e(roi_V2,:),1);

time_V2_cont_1203e=mean(a(roi_V2,:),1);
time_V2_non_1203e=mean(d(roi_V2,:),1);
time_V2_blank_1203e=mean(e(roi_V2,:),1);

time_V2_cont_1203f=mean(a(roi_V2,:),1);
time_V2_non_1203f=mean(d(roi_V2,:),1);
time_V2_blank_1203f=mean(e(roi_V2,:),1);





time_V2_cont(:,1)=time_V2_cont_1111c14;
time_V2_cont(:,2)=time_V2_cont_1111c25;
time_V2_cont(:,3)=time_V2_cont_1111d14;
time_V2_cont(:,4)=time_V2_cont_1111d25;
time_V2_cont(:,5)=time_V2_cont_1811c;
time_V2_cont(:,6)=time_V2_cont_1811d;
time_V2_cont(:,7)=time_V2_cont_1811e;
time_V2_cont(:,8)=time_V2_cont_2511d;
time_V2_cont(:,9)=time_V2_cont_2511e;
time_V2_cont(:,10)=time_V2_cont_2511f;
time_V2_cont(:,11)=time_V2_cont_1203d;
time_V2_cont(:,12)=time_V2_cont_1203e;
time_V2_cont(:,13)=time_V2_cont_1203f;


time_V2_non(:,1)=time_V2_non_1111c14;
time_V2_non(:,2)=time_V2_non_1111c25;
time_V2_non(:,3)=time_V2_non_1111d14;
time_V2_non(:,4)=time_V2_non_1111d25;
time_V2_non(:,5)=time_V2_non_1811c;
time_V2_non(:,6)=time_V2_non_1811d;
time_V2_non(:,7)=time_V2_non_1811e;
time_V2_non(:,8)=time_V2_non_2511d;
time_V2_non(:,9)=time_V2_non_2511e;
time_V2_non(:,10)=time_V2_non_2511f;
time_V2_non(:,11)=time_V2_non_1203d;
time_V2_non(:,12)=time_V2_non_1203e;
time_V2_non(:,13)=time_V2_non_1203f;


time_V2_blank(:,1)=time_V2_blank_1111c14;
time_V2_blank(:,2)=time_V2_blank_1111c25;
time_V2_blank(:,3)=time_V2_blank_1111d14;
time_V2_blank(:,4)=time_V2_blank_1111d25;
time_V2_blank(:,5)=time_V2_blank_1811c;
time_V2_blank(:,6)=time_V2_blank_1811d;
time_V2_blank(:,7)=time_V2_blank_1811e;
time_V2_blank(:,8)=time_V2_blank_2511d;
time_V2_blank(:,9)=time_V2_blank_2511e;
time_V2_blank(:,10)=time_V2_blank_2511f;
time_V2_blank(:,11)=time_V2_blank_1203d;
time_V2_blank(:,12)=time_V2_blank_1203e;
time_V2_blank(:,13)=time_V2_blank_1203f;




