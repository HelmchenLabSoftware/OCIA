
cont_distances_bg_bg=nan*ones(50,37);
non_distances_bg_bg=nan*ones(50,37);
diff_distances_bg_bg=nan*ones(50,37);

cont_distances_circ_circ=nan*ones(50,37);
non_distances_circ_circ=nan*ones(50,37);
diff_distances_circ_circ=nan*ones(50,37);

cd F:\Data\VSDI\Contour_integration\Smeagol\17Nov2010\b\pixelwise
ses=1:2;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\17Nov2010\c\pixelwise
ses=3:4;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\17Nov2010\g\pixelwise
ses=5:6;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\24Nov2010\b\pixelwise
ses=7:8;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\24Nov2010\d\pixelwise
ses=9:10;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\24Nov2010\f\pixelwise
ses=11:12;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\14Dec2010\b\pixelwise
ses=13:14;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\14Dec2010\c\pixelwise
ses=15;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\14Dec2010\d\pixelwise
ses=16;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\14Dec2010\e\pixelwise
ses=17;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\22Dec2010\b\pixelwise
ses=18:19;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\22Dec2010\c\pixelwise
ses=20;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\22Dec2010\d\pixelwise
ses=21;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\b\pixelwise
ses=22:23;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\c\pixelwise
ses=24:25;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\d\pixelwise
ses=26:27;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\e\pixelwise
ses=28:29;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\k\pixelwise
ses=30:31;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\05Jan2011\b\pixelwise
ses=32:33;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\05Jan2011\c\pixelwise
ses=34;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\05Jan2011\d\pixelwise
ses=35;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

cd F:\Data\VSDI\Contour_integration\Smeagol\05Jan2011\e\pixelwise
ses=36:37;
load corr_bg_bg_as_a_function_of_distance
cont_distances_bg_bg(1:size(dist_vec,2),ses)=dist_cont;
non_distances_bg_bg(1:size(dist_vec,2),ses)=dist_non;
diff_distances_bg_bg(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec
load corr_circ_circ_as_a_function_of_distance
cont_distances_circ_circ(1:size(dist_vec,2),ses)=dist_cont;
non_distances_circ_circ(1:size(dist_vec,2),ses)=dist_non;
diff_distances_circ_circ(1:size(dist_vec,2),ses)=dist_diff;
clear dist_diff dist_cont dist_non dist_vec

%%
cd F:\Data\VSDI\Contour_integration
load('correlation diffs_two_monkey_FOR_FIG.mat', 'ses1_smeg')
cd F:\Data\VSDI\Contour_integration\Smeagol\29Dec2010\d\pixelwise
load corr_bg_bg_as_a_function_of_distance
distances=nan*ones(1,50);
distances(1:size(dist_vec,2))=dist_vec;
clear dist_diff dist_cont dist_non dist_vec

for i=1:50
    n1(i)=sum(~isnan(cont_distances_circ_circ(i,ses1_smeg)));
    n2(i)=sum(~isnan(non_distances_circ_circ(i,ses1_smeg)));
    n3(i)=sum(~isnan(cont_distances_bg_bg(i,ses1_smeg)));
    n4(i)=sum(~isnan(non_distances_bg_bg(i,ses1_smeg)));
end


figure;plot(distances,nanmean(cont_distances_circ_circ(:,ses1_smeg),2))
hold on
plot(distances,nanmean(non_distances_circ_circ(:,ses1_smeg),2),'r')
xlim([0 6])
ylim([0.25 0.55])
figure;errorbar(distances,nanmean(diff_distances_circ_circ(:,ses1_smeg),2),nanstd(diff_distances_circ_circ(:,ses1_smeg),0,2)./sqrt(n1'))
hold on
plot(distances,zeros(1,50),'k')
xlim([0 6])
ylim([-0.03 0.06])

figure;plot(distances,nanmean(cont_distances_bg_bg(:,ses1_smeg),2))
hold on
plot(distances,nanmean(non_distances_bg_bg(:,ses1_smeg),2),'r')
xlim([0 8])
ylim([0.25 0.55])
figure;errorbar(distances,nanmean(diff_distances_bg_bg(:,ses1_smeg),2),nanstd(diff_distances_bg_bg(:,ses1_smeg),0,2)./sqrt(n3'))
hold on
plot(distances,zeros(1,50),'k')
xlim([0 8])
ylim([-0.04 0.02])


anova1(diff_distances_circ_circ(1:9,ses1_smeg)')
anova1(diff_distances_bg_bg(1:13,ses1_smeg)')

anova1(cont_distances_circ_circ(1:9,ses1_smeg)')
anova1(cont_distances_bg_bg(1:13,ses1_smeg)')

anova1(non_distances_circ_circ(1:9,ses1_smeg)')
anova1(non_distances_bg_bg(1:13,ses1_smeg)')




